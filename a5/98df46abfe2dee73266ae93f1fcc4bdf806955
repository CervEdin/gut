Note about POSIX compliance:

This script uses #!/bin/sh (not bash), but the duck typing detection still works
because:
- mktemp is POSIX (available on all modern systems)
- if/else syntax is POSIX shell
- Command substitution $(cmd) is POSIX

The only potential issue is if sed itself isn't available, but that would break
the entire script anyway.
